(()=>{let e={modalBlock:document.getElementById("modalBlock"),onShow:t=>{e.modalBlock.classList.remove("hide")},onHide:()=>{e.modalBlock.classList.add("hide")}},t={chatBlock:document.getElementById("chatBlock"),chatPublishRequestButton:document.getElementById("chatPublishRequest"),attacheInputLink:document.getElementById("attacheInputLink"),attacheInput:document.getElementById("attacheInput"),chatScreen:document.getElementById("chatScreen"),sendButton:document.getElementById("sendButton"),messageInput:document.getElementById("messageInput"),onPublishRequestClick:()=>{e.onShow()},handleFiles:()=>{let e=t.attacheInput.files;if(FileReader||alert("Your browser doesn't suppport FileReader"),FileReader&&e&&e.length){let n=e[0].type.split("/")[0];t.addSource(n,e[0])}},videoFileHtml:(e,n)=>`\n            <div class="item chat-item video-item" data-value="" id="item-${n}">\n            <div class="close-button" id="close-${n}"><img src='./images/close.svg'/></div>\n                <div class="item-block video-block-container">\n                    <div class="video-block center-flex">\n                        <div class="video">\n                            <video preload="metadata" id="${n}">\n                                <source src="${e}" type="video/mp4">\n                            </video>\n                            <div class="button-block" id="button-block-${n}">\n                                <div class="button" id="button-${n}">\n                                    <img src="./images/play-blue.svg" alt="">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="time">${t.getTime()}</div>\n                </div>\n            </div>\n        `,audioFileHtml:(e,n)=>`\n            <div class="item" id="item-${n}">\n            <div class="close-button" id="close-${n}"><img src='./images/close.svg'/></div>\n                <div class="item-block scale-block-container">\n                    <div class="audio-block">\n                        <audio controls id="${n}">\n                            <source src="${e}">\n                        </audio>\n                    </div>\n                    <div class="time">${t.getTime()}</div>\n                </div>\n            </div>\n        `,imageFileHtml:(e,n)=>`\n        <div class="item" id="item-${n}">\n        <div class="close-button" id="close-${n}"><img src='./images/close.svg'/></div>\n            <div class="item-block images-block-container">\n                <div class="image-block">\n                    <img id="${n}" src="${e}" alt="">\n                </div>\n                <div class="time">${t.getTime()}</div>\n            </div>\n        </div>\n        `,textHtml:(e,t)=>`\n            <div class="item" id="item-${t}">\n                <div class="close-button" id="close-${t}"><img src='./images/close.svg'/></div>\n                    <div class="item-block text-block-container">\n                        <div class="text-block">\n                            ${e}\n                        </div>\n                        <div class="time">2:25 PM</div>\n                    </div>\n                </div>\n            </div>\n        `,addSource:(e,n)=>{switch(e){case"video":t.addVideo(n);break;case"audio":t.addAudio(n);break;case"image":t.addImage(n);break;default:alert("Please attache video, audio or image")}},getTime:()=>{let e=new Date,t=e.getHours(),n="AM",i=e.getMinutes();return t>12&&(t-=12,n="PM"),i<10&&(i="0"+i),`${t}:${i} ${n}`},addImage:e=>{let n=new FileReader;n.readAsDataURL(e),n.onload=function(){let e="image-"+Math.floor(1e3*Math.random());new Promise(((i,a)=>{t.chatScreen.innerHTML+=t.imageFileHtml(n.result,e),i("ok")})).then((()=>{i()}))}},addAudio:e=>{let n=new FileReader;n.readAsDataURL(e),n.onload=function(){let e="audio-"+Math.floor(1e3*Math.random());document.getElementById("item-"+e),new Promise(((i,a)=>{t.chatScreen.innerHTML+=t.audioFileHtml(n.result,e),i("ok")})).then((()=>{document.getElementById("close-"+e),document.getElementById("item-"+e),i()}))}},addVideo:e=>{let n=new FileReader;n.readAsDataURL(e),n.onload=function(){let e="video-"+Math.floor(1e3*Math.random());new Promise(((i,a)=>{t.chatScreen.innerHTML+=t.videoFileHtml(n.result,e),i("ok")})).then((()=>{let t="button-"+e,n=document.getElementById(t),a=document.getElementById(e),d=document.getElementById("button-block-"+e);document.getElementById("item-"+e),document.getElementById("close-"+e),n.addEventListener("click",(function(){d.style.display="none",a.play(),a.setAttribute("data-state","play")})),a.addEventListener("click",(function(){switch(d.style.display="none",a.dataset.state){case"play":a.pause(),a.setAttribute("data-state","pause");break;case"pause":a.play(),a.setAttribute("data-state","play")}})),i()}))}},addText:e=>{let n="message-"+Math.floor(1e3*Math.random());new Promise(((i,a)=>{t.chatScreen.innerHTML+=t.textHtml(e,n),i("ok")})).then((()=>{i()}))}};var n;function i(){n=document.getElementsByClassName("close-button");for(let e=0;e<n.length;e++)n[e].addEventListener("click",(function(){this.parentElement.remove()}))}t.chatPublishRequestButton.addEventListener("click",chatModal.onPublishRequestClick),t.attacheInputLink.addEventListener("click",(function(e){e.preventDefault(),t.attacheInput.click()})),t.attacheInput.addEventListener("change",t.handleFiles,!1),t.sendButton.addEventListener("click",(function(){t.messageInput.value&&(t.addText(t.messageInput.value),t.messageInput.value=null)}))})();