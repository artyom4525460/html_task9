(()=>{let e={modalBlock:document.getElementById("modalBlock"),modalEditButton:document.getElementById("modalEditButton"),onShow:t=>{e.modalBlock.classList.remove("hide")},onHide:()=>{e.modalBlock.classList.add("hide")}},t={chatBlock:document.getElementById("chatBlock"),chatPublishRequestButton:document.getElementById("chatPublishRequest"),attacheInputLink:document.getElementById("attacheInputLink"),attacheInput:document.getElementById("attacheInput"),chatScreen:document.getElementById("chatScreen"),sendButton:document.getElementById("sendButton"),messageInput:document.getElementById("messageInput"),chatEmptyBlock:document.getElementById("chatEmptyBlock"),hideChatEmptyBlock:()=>{t.chatEmptyBlock.classList.add("hide")},showChatEmptyBlock:()=>{t.chatEmptyBlock.classList.remove("hide")},onPublishRequestClick:()=>{e.onShow()},enablePublishRequest:()=>{t.chatPublishRequestButton.classList.remove("disable")},disablePublishRequest:()=>{t.chatPublishRequestButton.classList.add("disable")},handleFiles:()=>{let e=t.attacheInput.files;if(FileReader||alert("Your browser doesn't suppport FileReader"),FileReader&&e&&e.length){let a=e[0].type.split("/")[0];t.addSource(a,e[0]),attacheInput.value=null}},videoFileHtml:(e,t)=>`\n            <div class="item" id="item-${t}">\n                <div class="close-button" id="close-${t}"><img src='./images/close.svg'/></div>\n                <div class="attache video">\n                    <video preload="metadata" id="${t}">\n                        <source src="${e}" type="video/mp4">\n                    </video>\n                    <div class="video-button-block" id="button-block-${t}">\n                        <div class="video-button" id="button-${t}">\n                            <img src="./images/play.svg" alt="">\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `,audioFileHtml:(e,a)=>`\n            <div class="item" id="item-${a}">\n                <div class="close-button" id="close-${a}"><img src='./images/close.svg'/></div>\n                <div class="audio">\n                    <audio controls id="${a}">\n                        <source src="${e}">\n                    </audio>\n                </div>\n                <div class="time">${t.getTime()}</div>\n            </div>\n        `,imageFileHtml:(e,t)=>`\n            <div class="item" id="item-${t}">\n                <div class="close-button" id="close-${t}"><img src='./images/close.svg'/></div>\n                <div class="image">\n                    <img id="${t}" src="${e}" alt="">\n                </div>\n            </div>\n        `,textHtml:(e,a)=>`\n            <div class="item" id="item-${a}">\n                <div class="close-button" id="close-${a}"><img src='./images/close.svg'/></div>\n                <div class="text">\n                    ${e}\n                </div>\n                <div class="time">${t.getTime()}</div>\n            </div>\n        `,addSource:(e,a)=>{switch(e){case"video":t.addVideo(a);break;case"audio":t.addAudio(a);break;case"image":t.addImage(a);break;default:alert("Please attache video, audio or image")}t.chatEmptyBlock.classList.contains("hide")||t.hideChatEmptyBlock(),t.chatPublishRequestButton.classList.contains("disable")||t.enablePublishRequest()},getTime:()=>{let e=new Date,t=e.getHours(),a="AM",n=e.getMinutes();return t>12&&(t-=12,a="PM"),n<10&&(n="0"+n),`${t}:${n}${a}`},addImage:e=>{let a=new FileReader;a.readAsDataURL(e),a.onload=function(){let e="image-"+Math.floor(1e3*Math.random());new Promise(((n,d)=>{t.chatScreen.innerHTML+=t.imageFileHtml(a.result,e),n("ok")})).then((()=>{n()}))}},addAudio:e=>{let a=new FileReader;a.readAsDataURL(e),a.onload=function(){let e="audio-"+Math.floor(1e3*Math.random());document.getElementById("item-"+e),new Promise(((n,d)=>{t.chatScreen.innerHTML+=t.audioFileHtml(a.result,e),n("ok")})).then((()=>{document.getElementById("close-"+e),document.getElementById("item-"+e),n()}))}},addVideo:e=>{let a=new FileReader;a.readAsDataURL(e),a.onload=function(){let e="video-"+Math.floor(1e3*Math.random());new Promise(((n,d)=>{t.chatScreen.innerHTML+=t.videoFileHtml(a.result,e),n("ok")})).then((()=>{let t="button-"+e,a=document.getElementById(t),d=document.getElementById(e),i=document.getElementById("button-block-"+e);document.getElementById("item-"+e),document.getElementById("close-"+e),a.addEventListener("click",(function(){i.style.display="none",d.play(),d.setAttribute("data-state","play")})),d.addEventListener("click",(function(){switch(i.style.display="none",d.dataset.state){case"play":d.pause(),d.setAttribute("data-state","pause");break;case"pause":d.play(),d.setAttribute("data-state","play")}})),n()}))}},addText:e=>{let a="message-"+Math.floor(1e3*Math.random());new Promise(((n,d)=>{t.chatScreen.innerHTML+=t.textHtml(e,a),n("ok")})).then((()=>{n()}))}};var a;function n(){a=document.getElementsByClassName("close-button");for(let e=0;e<a.length;e++)a[e].addEventListener("click",(function(){this.parentElement.remove()}))}e.modalEditButton.addEventListener("click",e.onHide),t.chatPublishRequestButton.addEventListener("click",e.onShow),t.attacheInputLink.addEventListener("click",(function(e){e.preventDefault(),t.attacheInput.click()})),t.attacheInput.addEventListener("change",t.handleFiles,!1),t.sendButton.addEventListener("click",(function(){t.messageInput.value&&(t.hideChatEmptyBlock(),t.enablePublishRequest(),t.addText(t.messageInput.value),t.messageInput.value=null)}))})();